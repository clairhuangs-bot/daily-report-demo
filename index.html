<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>å®¢æœæ•¸æ“šè‡ªå‹•åŒ–åˆ†æç³»çµ± v7.5 | Enterprise Edition</title>

  <!-- âœ… GitHub Pages å‹å–„ï¼šå…¨éƒ¨ç”¨ CDNï¼Œä¸éœ€è¦ Node -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700;900&display=swap');

    :root { --primary:#2563eb; --primary-dark:#1e40af; --accent:#f59e0b; }
    body { font-family:'Noto Sans TC',sans-serif; background:#f8fafc; color:#1e293b; }

    .glass-header { background:rgba(15,23,42,.95); backdrop-filter:blur(12px); border-bottom:1px solid rgba(255,255,255,.1); }
    .custom-card { background:white; border-radius:1rem; box-shadow:0 4px 6px -1px rgba(0,0,0,.1),0 2px 4px -1px rgba(0,0,0,.06); border:1px solid #e2e8f0; }
    .sticky-col { position:sticky; left:0; background:white; z-index:20; border-right:2px solid #f1f5f9; }

    .tab-btn { position:relative; padding:1rem 1.25rem; font-weight:800; color:#64748b; transition:all .2s; white-space:nowrap; font-size:.9rem; }
    .tab-btn:hover { color:var(--primary); }
    .tab-btn.active { color:var(--primary); }
    .tab-btn.active::after { content:''; position:absolute; bottom:0; left:50%; transform:translateX(-50%); width:30px; height:4px; background:var(--primary); border-radius:2px; }

    .trend-up { color:#ef4444; font-weight:800; }
    .trend-down { color:#10b981; font-weight:800; }
    .peak-cell { background:linear-gradient(to bottom,#fffbeb,#fef3c7)!important; color:#92400e!important; }

    .animate-fade { animation:fadeIn .25s ease-out forwards; }
    @keyframes fadeIn { from { opacity:0; transform:translateY(10px);} to { opacity:1; transform:translateY(0);} }

    ::-webkit-scrollbar { width:6px; height:6px; }
    ::-webkit-scrollbar-track { background:#f1f5f9; }
    ::-webkit-scrollbar-thumb { background:#cbd5e1; border-radius:10px; }

    .collapsible-content { transition:max-height .3s ease-out, opacity .3s; max-height:2000px; overflow:hidden; opacity:1; }
    .collapsible-content.collapsed { max-height:0!important; opacity:0!important; pointer-events:none!important; margin:0!important; padding:0!important; }
    .rotate-icon { transition:transform .3s; }
    .is-collapsed .rotate-icon { transform:rotate(-90deg); }

    .copy-sub-btn { padding:2px 8px; border-radius:6px; font-size:10px; font-weight:900; transition:all .2s; border:1px solid transparent; }
    .copy-sub-btn:active { transform:scale(.95); }

    .bar-container { display:flex; align-items:flex-end; gap:12px; height:200px; padding:20px 0; }
    .bar-segment { width:40px; border-radius:4px 4px 0 0; transition:all .3s; position:relative; cursor:help; }
    .bar-segment:hover { filter:brightness(1.1); transform:scaleX(1.05); }
  </style>
</head>

<body class="pb-12 text-left">

  <!-- Header -->
  <header class="glass-header sticky top-0 z-50 px-6 py-4 mb-8 text-white">
    <div class="max-w-[1400px] mx-auto flex flex-col md:flex-row justify-between items-center gap-4">
      <div class="flex items-center gap-4">
        <div class="bg-gradient-to-br from-blue-600 to-indigo-800 p-3 rounded-2xl shadow-lg text-white">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-7 h-7" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5"
              d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2-2H5a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
          </svg>
        </div>
        <div class="text-left text-white">
          <h1 class="text-xl font-black tracking-tight flex items-center gap-2">
            å®¢æœæ•¸æ“šè‡ªå‹•åŒ–åˆ†æç³»çµ± <span class="text-blue-400 font-mono text-sm px-2 py-0.5 bg-blue-500/10 rounded">v7.5</span>
          </h1>
          <p class="text-slate-400 text-[10px] font-bold uppercase tracking-[0.2em]">Enterprise Data Management</p>
        </div>
      </div>

      <div class="flex items-center gap-4 bg-slate-800/50 p-1.5 rounded-2xl border border-slate-700 shadow-inner text-white">
        <div class="px-3 flex flex-col text-left">
          <span class="text-[9px] text-slate-500 font-black uppercase tracking-wider">åŸºæº–æ—¥æœŸé¸æ“‡</span>
          <input type="date" id="report-date" class="bg-transparent text-white font-bold outline-none text-sm cursor-pointer border-none p-0" onchange="refreshUI()">
        </div>
        <div class="w-px h-8 bg-slate-700"></div>

        <div class="flex gap-2">
          <button onclick="exportBackup()" class="p-2 text-blue-400 hover:bg-blue-500/20 rounded-lg transition-colors" title="ä¸‹è¼‰å‚™ä»½ (.json)">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
            </svg>
          </button>
          <button onclick="document.getElementById('import-input').click()" class="p-2 text-emerald-400 hover:bg-emerald-500/20 rounded-lg transition-colors" title="åŒ¯å…¥å‚™ä»½é‚„åŸ">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0l-4 4m4-4v12" />
            </svg>
          </button>
          <input type="file" id="import-input" class="hidden" accept=".json" onchange="importBackup(this)">
        </div>

        <div class="w-px h-8 bg-slate-700"></div>
        <button onclick="clearAllData()" class="px-3 py-1.5 bg-red-500/10 hover:bg-red-500 text-red-500 hover:text-white rounded-lg text-xs font-black transition-all">
          é‡ç½®ç³»çµ±æ•¸æ“š
        </button>
      </div>
    </div>
  </header>

  <main class="max-w-[1400px] mx-auto px-6 text-left">

    <!-- Upload -->
    <div id="upload-window" class="custom-card mb-8 overflow-hidden">
      <div onclick="toggleUploadWindow()" class="px-6 py-4 bg-slate-50 border-b border-slate-100 flex justify-between items-center cursor-pointer hover:bg-slate-100 transition-colors">
        <div class="flex items-center gap-3">
          <div class="p-2 bg-blue-600 rounded-lg text-white shadow-md">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5"
                d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
            </svg>
          </div>
          <span class="text-sm font-black text-slate-800">æ•¸æ“šæºåŒ¯å…¥å€ (å·²å€åˆ†æ»¿è²«å¤§äº¨/å¤§æ»¿è²«)</span>
        </div>
        <svg id="upload-rotate-icon" xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-slate-400 rotate-icon transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M19 9l-7 7-7-7" />
        </svg>
      </div>

      <div id="upload-window-content" class="collapsible-content">
        <div id="drop-zone" class="p-10 flex flex-col items-center justify-center cursor-pointer hover:bg-blue-50/20 transition-all group">
          <input type="file" id="file-input" class="hidden" accept=".xlsx, .xls" multiple>
          <div class="p-6 bg-blue-50 rounded-3xl text-blue-500 mb-4 group-hover:scale-110 transition-transform text-center">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-10 h-10" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 4v16m8-8H4" />
            </svg>
          </div>
          <h3 class="text-xl font-black text-slate-800 text-center">é¸å–æˆ–æ‹–å…¥ Excel æª”æ¡ˆ</h3>
          <p class="text-slate-400 mt-2 text-sm text-center font-bold italic">è‡ªå‹•ä¾ç…§é—œéµå­—éæ¿¾ä¸¦å½™æ•´æ•¸æ“š</p>
        </div>

        <div id="file-toggle-bar" class="hidden border-t border-slate-100 bg-slate-50 px-6 py-3 flex justify-between items-center">
          <span class="text-xs font-black text-slate-500 uppercase tracking-wider">è™•ç†æª”æ¡ˆæ•¸: <span id="file-count-badge">0</span></span>
          <button onclick="clearUploadCache()" class="text-[10px] text-blue-600 font-bold underline">æ¸…é™¤è™•ç†å¿«å–</button>
        </div>
        <div id="file-progress" class="p-4 flex flex-wrap gap-2 bg-slate-50/50 text-xs font-bold"></div>
      </div>
    </div>

    <!-- Tabs -->
    <div id="tab-container" class="hidden mb-6 flex flex-col md:flex-row md:items-center justify-between gap-4 border-b border-slate-200 pb-px">
      <div class="flex items-center gap-2 overflow-x-auto pb-px">
        <button class="tab-btn active" data-tab="summary" onclick="switchTab('summary')">æ¯æ—¥å½™æ•´</button>
        <button class="tab-btn" data-tab="reporting" onclick="switchTab('reporting')">å›å ±+ä¿¡ä»¶ ğŸ“Š</button>
        <button class="tab-btn" data-tab="tickets" onclick="switchTab('tickets')">å›å–®çµ±è¨ˆ ğŸ“„</button>
        <button class="tab-btn" data-tab="phoneAnalysis" onclick="switchTab('phoneAnalysis')">é›»è©±é€²ç·šåˆ†æ ğŸ“</button>
        <button class="tab-btn" data-tab="history" onclick="switchTab('history')">è¶¨å‹¢æ­·ç¨‹ ğŸ‘‘</button>
        <button class="tab-btn" data-tab="busyAnalysis" onclick="switchTab('busyAnalysis')">å¿™ç¢Œç†±é»åˆ†æ ğŸ”¥</button>
        <button class="tab-btn" data-tab="full" onclick="switchTab('full')">åŸå§‹æ˜ç´°</button>
      </div>
      <button id="copy-btn" class="mb-2 md:mb-0 px-6 py-3 bg-slate-900 text-white rounded-xl font-black text-xs shadow-lg hover:bg-black active:scale-[0.98] transition-all flex items-center gap-2">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m-7 10h7m-7-3h7" />
        </svg>
        è¤‡è£½ç›®å‰å ±è¡¨
      </button>
    </div>

    <!-- Result -->
    <div id="result-container" cl
